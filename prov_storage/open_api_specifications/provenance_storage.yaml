openapi: 3.0.0
info:
  description: OpenAPI specification of Provenance storage API
  version: "1.0.0"
  title: Provenance storage API
  contact:
    email: 468971@fi.muni.cz
  license:
    name: Apache 2.0
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
servers:
  - url: '{uri}/api/v1'
    variables:
      uri:
        default: https://provenance-storage.com
        description: Scheme and authority as defined in Section 3.3 of RFC 3986
paths:
  /organizations/{org_id}:
    post:
      summary: Registers an organization
      description: |
        By passing a valid client certificate and valid intermediate certificates,
        registers an organization with identifier {org_id}
        The registration is only required when 'disableTrustedParty' configuration option is set to False
      parameters:
        - name: org_id
          in: path
          description: Organization ID
          required: true
          schema:
            type: string
            example: "MUNI"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrganizationInfo'
      responses:
        '201':
          description: Organization created
        '400':
          description: Missing mandatory parameter of the body
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unverifiable chain of trust of client and intermediate certificates
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: The organization {org_id} is already registered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      summary: Updates organization's certificates
      description: |
        Updates certificates of organization with identifier {org_id}. If the 
        client certificate and intermediate certificates create a valid certificate chain,
        the certificates are updated
        The modification is only allowed when 'disableTrustedParty' configuration option is set to False
      parameters:
        - name: org_id
          in: path
          description: Organization ID
          required: true
          schema:
            type: string
            example: "MUNI"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrganizationInfo'
      responses:
        '200':
          description: Organization info updated
        '400':
          description: Missing mandatory parameter of the body
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unverifiable chain of trust of client and intermediate certificates
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: The organization {org_id} is not registered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /organizations/{org_id}/documents/{document_id}:
    post:
      summary: Store a PROV document
      description: Stores a PROV document
      parameters:
        - name: org_id
          in: path
          description: Organization ID
          required: true
          schema:
            type: string
            example: "MUNI"
        - name: document_id
          in: path
          description: Identifier of a document that is being stored
          required: true
          schema:
            type: string
            example: "01_sample_acquisition"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/Document'
                - $ref: '#/components/schemas/DocumentNoTrustedParty'
      responses:
        '201':
          description: Document created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
        '400':
          description: Missing mandatory parameter of the body
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unverifiable signature of the document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: |
            Returned when the organization {org_id} is not registered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: | 
            Returned when the document {document_id} already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      summary: Update a PROV document
      description: |
        Updates a PROV document (creates newer version of the document
        and records such change in the meta provenance)
      parameters:
        - name: org_id
          in: path
          description: Organization ID
          required: true
          schema:
            type: string
            example: "MUNI"
        - name: document_id
          in: path
          description: Identifier of the modified document (the previous version)
          required: true
          schema:
            type: string
            example: "01_sample_acquisition"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/Document'
                - $ref: '#/components/schemas/DocumentNoTrustedParty'
      responses:
        '201':
          description: Document created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
        '400':
          description: Missing mandatory parameter of the body
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unverifiable signature of the document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: | 
            Returned when:
              - the organization {org_id} is not registered
              - the document {document_id} does not exist
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Returned when a document with the same BUNDLE identifier already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    get:
      summary: Retrieves a PROV document
      description: Retrieves a PROV document
      parameters:
        - name: org_id
          in: path
          description: Organization ID
          required: true
          schema:
            type: string
            example: MUNI
        - name: document_id
          in: path
          description: Identifier of a retrieved document
          required: true
          schema:
            type: string
            example: "01_sample_acquisition"
      responses:
        '200':
          description: Successful retrieval of a document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrievedDocument'
        '404':
          description: |
            Returned when a document {document_id} does not exist under organization {org_id}
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /organizations/{org_id}/documents/{document_id}/domain-specific:
    get:
      summary: Retrieves a domain specific part of a PROV document
      description: Retrieves a domain specific part of a PROV document
      parameters:
        - name: org_id
          in: path
          description: Organization ID
          required: true
          schema:
            type: string
            example: "MUNI"
        - name: document_id
          in: path
          description: Identifier of a retrieved document
          required: true
          schema:
            type: string
            example: "01_sample_acquisition"
        - name: format
          in: query
          description: |
              Specifier of a required format of the domain specific part of the document
          required: false
          schema:
            type: string
            enum: 
            - json
            - rdf
            - xml
            example: json
      responses:
        '200':
          description: Successful retrieval of the domain specific part of the document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrievedDocument'
        '400':
          description: Returned when the 'format' query param is not supported
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: | 
            Returned when a document {document_id} does not exist under organization {org_id}
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /organizations/{org_id}/documents/{document_id}/backbone:
    get:
      summary: Retrieves a provenance backbone part of a PROV document
      description: Retrieves a provenance backbone part of a PROV document
      parameters:
        - name: org_id
          in: path
          description: Organization ID
          required: true
          schema:
            type: string
            example: "MUNI"
        - name: document_id
          in: path
          description: Identifier of a retrieved document
          required: true
          schema:
            type: string
            example: "01_sample_acquisition"
        - name: format
          in: query
          description: |
              Specifier of a required format of the backbone part of the document
          required: false
          schema:
            type: string
            enum: 
            - json
            - rdf
            - xml
            example: "json"
      responses:
        '200':
          description: Successful retrieval of the backbone part of the document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrievedDocument'
        '400':
          description: Returned when the 'format' query param is not supported
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: | 
            Returned when a document {document_id} does not exist under organization {org_id}
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /documents/meta/{meta_id}:
    get:
      summary: Retrieves a meta provenance
      description: Retrieves a meta provenance
      parameters:
        - name: meta_id
          in: path
          description: Identifier of a meta provenance
          required: true
          schema:
            type: string
            example: "meta1"
        - name: format
          in: query
          description: Specifier of a required format of the meta provenance
          required: false
          schema:
            type: string
            enum: 
            - json
            - rdf
            - xml
            example: "json"
      responses:
        '200':
          description: Successful retrieval of the meta provenance
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrievedDocument'
        '400':
          description: Returned when the 'format' query param is not supported
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Returned when the meta {meta_id} does not exist
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /connectors/{connector_id}:
    get:
      summary: Retrieves a connector table
      description: Retrieves a connector table
      parameters:
        - name: connector_id
          in: path
          description: Identifier of a meta provenance
          required: true
          schema:
            type: string
            example: "sampleConnector"
        - name: format
          in: query
          description: Specifier of a required format of the connector table
          required: false
          schema:
            type: string
            enum: 
            - json
            - rdf
            - xml
            example: "json"
      responses:
        '200':
          description: Successful retrieval of the connector table
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConectorTable'
        '400':
          description: Returned when the 'format' query param is not supported
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Returned when the connector table {connector_id} does not exist
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          
components:
  schemas:
    OrganizationInfo:
      type: object
      required:
        - clientCertificate
        - intermediateCertificates
        - clearancePeriod
      properties:
        clientCertificate:
          type: string
          description: PEM certificate of the organization
        intermediateCertificates:
          type: array
          description: Array of PEM certificates of intermediate authorities
          items:
            type: string
        clearancePeriod:
          type: integer
          description: Amount of time to report a confidentiality violation of the private key (in days)
          example: 30
    Document:
      type: object
      required:
       - document
       - documentFormat
       - signature
       - createdOn
      properties:
        document:
          type: string
          description: Base64 encoded PROV document
          example: |
            ewogICJwcmVmaXgiIDogewogICAgInhzZCIgOiAiaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEjIiwKICAgICJwcm92IiA6ICJodHRwOi8vd3d3LnczLm9yZy9ucy9wcm92IyIsCiAgICAibnNfc3VyZ2VyeSIgOiAiaHR0cDovL3Byb3ZlbmFuY2Utc3RvcmFnZS1wcm92aWRlci5jb206ODAwMC9hcGkvdjEvb3JnYW5pemF0aW9ucy9VbmlHcmF6L2dyYXBocy8iCiAgfSwKICAiYnVuZGxlIiA6IHsKICAgICJuc19zdXJnZXJ5OjAxX3NhbXBsZV9hY3F1aXNpdGlvbiIgOiB7CiAgICAgICJwcmVmaXgiIDogewogICAgICAgICJjcG0iIDogImh0dHBzOi8vd3d3LmNvbW1vbnByb3ZlbmFuY2Vtb2RlbC5vcmcvY3BtLW5hbWVzcGFjZS12MS0wLyIsCiAgICAgICAgImRjdCIgOiAiaHR0cDovL3B1cmwub3JnL2RjL3Rlcm1zLyIsCiAgICAgICAgInNlbGZfY29ubmVjdG9yIiA6ICJodHRwOi8vcHJvdmVuYW5jZS1zdG9yYWdlLXByb3ZpZGVyLmNvbTo4MDAwL2FwaS92MS9jb25uZWN0b3JzLyIsCiAgICAgICAgIm1ldGEiIDogImh0dHA6Ly9wcm92ZW5hbmNlLXN0b3JhZ2UtcHJvdmlkZXIuY29tOjgwMDAvYXBpL3YxL2dyYXBocy9tZXRhLyIsCiAgICAgICAgInhzZCIgOiAiaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEjIiwKICAgICAgICAicHJvdiIgOiAiaHR0cDovL3d3dy53My5vcmcvbnMvcHJvdiMiLAogICAgICAgICJuc19zdXJnZXJ5IiA6ICJodHRwOi8vcHJvdmVuYW5jZS1zdG9yYWdlLXByb3ZpZGVyLmNvbTo4MDAwL2FwaS92MS9vcmdhbml6YXRpb25zL1VuaUdyYXovZ3JhcGhzLyIKICAgICAgfSwKICAgICAgImVudGl0eSIgOiB7CiAgICAgICAgIm5zX3N1cmdlcnk6cGF0aWVudCIgOiB7CiAgICAgICAgICAibnNfc3VyZ2VyeTpiaW9wdGljLWFwcC1pZCIgOiBbICJhcHAtaWQtMCIgXSwKICAgICAgICAgICJjcG06ZXh0ZXJuYWxJZCIgOiBbICJwYXRpZW50LWlkLTAiIF0KICAgICAgICB9LAogICAgICAgICJzZWxmX2Nvbm5lY3RvcjpzYW1wbGVDb25uZWN0b3IiIDogewogICAgICAgICAgImNwbTpyZWNlaXZlclNlcnZpY2VVcmkiIDogWyAiI1VSSSMiIF0sCiAgICAgICAgICAicHJvdjp0eXBlIiA6IFsgewogICAgICAgICAgICAidHlwZSIgOiAicHJvdjpRVUFMSUZJRURfTkFNRSIsCiAgICAgICAgICAgICIkIiA6ICJjcG06Zm9yd2FyZENvbm5lY3RvciIKICAgICAgICAgIH0gXQogICAgICAgIH0sCiAgICAgICAgIm5zX3N1cmdlcnk6U2FtcGxlIiA6IHsKICAgICAgICAgICJjcG06ZXh0ZXJuYWxJZCIgOiBbICJ0aXNzdWUtaWQtMCIgXQogICAgICAgIH0sCiAgICAgICAgIm5zX3N1cmdlcnk6dGlzc3VlU2FtcGxlIiA6IHsKICAgICAgICAgICJjcG06ZXh0ZXJuYWxJZCIgOiBbICJzYW1wbGUtaWQtMCIgXQogICAgICAgIH0sCiAgICAgICAgIm5zX3N1cmdlcnk6cHJlcGFyZWRTYW1wbGUiIDogewogICAgICAgICAgImNwbTpleHRlcm5hbElkIiA6IFsgInNhbXBsZS1pZC0wIiBdCiAgICAgICAgfQogICAgICB9LAogICAgICAiYWN0aXZpdHkiIDogewogICAgICAgICJuc19zdXJnZXJ5OnNhbXBsZVByZXBhcmF0aW9uIiA6IHsgfSwKICAgICAgICAibnNfc3VyZ2VyeTpzYW1wbGVUcmFuc3BvcnQiIDogeyB9LAogICAgICAgICJuc19zdXJnZXJ5OmJpb21hdGVyaWFsQ29sbGVjdGlvbiIgOiB7IH0sCiAgICAgICAgIm5zX3N1cmdlcnk6c2FtcGxlQWNxdWlzaXRpb24iIDogewogICAgICAgICAgImNwbTptZXRhYnVuZGxlIiA6IFsgewogICAgICAgICAgICAidHlwZSIgOiAicHJvdjpRVUFMSUZJRURfTkFNRSIsCiAgICAgICAgICAgICIkIiA6ICJtZXRhOm1ldGExIgogICAgICAgICAgfSBdLAogICAgICAgICAgImRjdDpoYXNQYXJ0IiA6IFsgewogICAgICAgICAgICAidHlwZSIgOiAicHJvdjpRVUFMSUZJRURfTkFNRSIsCiAgICAgICAgICAgICIkIiA6ICJuc19zdXJnZXJ5OnNhbXBsZVRyYW5zcG9ydCIKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgInR5cGUiIDogInByb3Y6UVVBTElGSUVEX05BTUUiLAogICAgICAgICAgICAiJCIgOiAibnNfc3VyZ2VyeTpiaW9tYXRlcmlhbENvbGxlY3Rpb24iCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgICJ0eXBlIiA6ICJwcm92OlFVQUxJRklFRF9OQU1FIiwKICAgICAgICAgICAgIiQiIDogIm5zX3N1cmdlcnk6c2FtcGxlUHJlcGFyYXRpb24iCiAgICAgICAgICB9IF0sCiAgICAgICAgICAicHJvdjp0eXBlIiA6IFsgewogICAgICAgICAgICAidHlwZSIgOiAicHJvdjpRVUFMSUZJRURfTkFNRSIsCiAgICAgICAgICAgICIkIiA6ICJjcG06bWFpbkFjdGl2aXR5IgogICAgICAgICAgfSwgewogICAgICAgICAgICAidHlwZSIgOiAicHJvdjpRVUFMSUZJRURfTkFNRSIsCiAgICAgICAgICAgICIkIiA6ICJjcG06c2FtcGxlQWNxdWlzaXRpb24iCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgICJ0eXBlIiA6ICJwcm92OlFVQUxJRklFRF9OQU1FIiwKICAgICAgICAgICAgIiQiIDogImNwbTpzYW1wbGVIYW5kbGluZyIKICAgICAgICAgIH0gXQogICAgICAgIH0KICAgICAgfSwKICAgICAgImFnZW50IiA6IHsKICAgICAgICAibnNfc3VyZ2VyeTpwYXRob2xvZ3lEZXBhcnRtZW50IiA6IHsKICAgICAgICAgICJjcG06Y29udGFjdElkUGlkIiA6IFsgIiIgXSwKICAgICAgICAgICJwcm92OnR5cGUiIDogWyB7CiAgICAgICAgICAgICJ0eXBlIiA6ICJwcm92OlFVQUxJRklFRF9OQU1FIiwKICAgICAgICAgICAgIiQiIDogImNwbTpyZWNlaXZlckFnZW50IgogICAgICAgICAgfSBdCiAgICAgICAgfSwKICAgICAgICAibnNfc3VyZ2VyeTpzdXJnaWNhbERlcGFydG1lbnQiIDogeyB9CiAgICAgIH0sCiAgICAgICJ1c2VkIiA6IHsKICAgICAgICAiXzpuOCIgOiB7CiAgICAgICAgICAicHJvdjphY3Rpdml0eSIgOiAibnNfc3VyZ2VyeTpzYW1wbGVQcmVwYXJhdGlvbiIsCiAgICAgICAgICAicHJvdjplbnRpdHkiIDogIm5zX3N1cmdlcnk6dGlzc3VlU2FtcGxlIgogICAgICAgIH0sCiAgICAgICAgIl86bjUiIDogewogICAgICAgICAgInByb3Y6YWN0aXZpdHkiIDogIm5zX3N1cmdlcnk6YmlvbWF0ZXJpYWxDb2xsZWN0aW9uIiwKICAgICAgICAgICJwcm92OmVudGl0eSIgOiAibnNfc3VyZ2VyeTpwYXRpZW50IgogICAgICAgIH0sCiAgICAgICAgIl86bjEyIiA6IHsKICAgICAgICAgICJwcm92OmFjdGl2aXR5IiA6ICJuc19zdXJnZXJ5OnNhbXBsZVRyYW5zcG9ydCIsCiAgICAgICAgICAicHJvdjplbnRpdHkiIDogIm5zX3N1cmdlcnk6cHJlcGFyZWRTYW1wbGUiCiAgICAgICAgfQogICAgICB9LAogICAgICAid2FzQXNzb2NpYXRlZFdpdGgiIDogewogICAgICAgICJfOm4yIiA6IHsKICAgICAgICAgICJwcm92OmFjdGl2aXR5IiA6ICJuc19zdXJnZXJ5OmJpb21hdGVyaWFsQ29sbGVjdGlvbiIsCiAgICAgICAgICAicHJvdjphZ2VudCIgOiAibnNfc3VyZ2VyeTpzdXJnaWNhbERlcGFydG1lbnQiCiAgICAgICAgfSwKICAgICAgICAiXzpuMyIgOiB7CiAgICAgICAgICAicHJvdjphY3Rpdml0eSIgOiAibnNfc3VyZ2VyeTpzYW1wbGVQcmVwYXJhdGlvbiIsCiAgICAgICAgICAicHJvdjphZ2VudCIgOiAibnNfc3VyZ2VyeTpzdXJnaWNhbERlcGFydG1lbnQiCiAgICAgICAgfSwKICAgICAgICAiXzpuNCIgOiB7CiAgICAgICAgICAicHJvdjphY3Rpdml0eSIgOiAibnNfc3VyZ2VyeTpzYW1wbGVUcmFuc3BvcnQiLAogICAgICAgICAgInByb3Y6YWdlbnQiIDogIm5zX3N1cmdlcnk6c3VyZ2ljYWxEZXBhcnRtZW50IgogICAgICAgIH0KICAgICAgfSwKICAgICAgIndhc0F0dHJpYnV0ZWRUbyIgOiB7CiAgICAgICAgIl86bjEiIDogewogICAgICAgICAgInByb3Y6ZW50aXR5IiA6ICJzZWxmX2Nvbm5lY3RvcjpzYW1wbGVDb25uZWN0b3IiLAogICAgICAgICAgInByb3Y6YWdlbnQiIDogIm5zX3N1cmdlcnk6cGF0aG9sb2d5RGVwYXJ0bWVudCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgICJzcGVjaWFsaXphdGlvbk9mIiA6IHsKICAgICAgICAiXzpuMTEiIDogewogICAgICAgICAgInByb3Y6c3BlY2lmaWNFbnRpdHkiIDogIm5zX3N1cmdlcnk6U2FtcGxlIiwKICAgICAgICAgICJwcm92OmdlbmVyYWxFbnRpdHkiIDogInNlbGZfY29ubmVjdG9yOnNhbXBsZUNvbm5lY3RvciIKICAgICAgICB9CiAgICAgIH0sCiAgICAgICJ3YXNEZXJpdmVkRnJvbSIgOiB7CiAgICAgICAgIl86bjE0IiA6IHsKICAgICAgICAgICJwcm92OmdlbmVyYXRlZEVudGl0eSIgOiAibnNfc3VyZ2VyeTpTYW1wbGUiLAogICAgICAgICAgInByb3Y6dXNlZEVudGl0eSIgOiAibnNfc3VyZ2VyeTpwcmVwYXJlZFNhbXBsZSIKICAgICAgICB9LAogICAgICAgICJfOm4xMCIgOiB7CiAgICAgICAgICAicHJvdjpnZW5lcmF0ZWRFbnRpdHkiIDogIm5zX3N1cmdlcnk6cHJlcGFyZWRTYW1wbGUiLAogICAgICAgICAgInByb3Y6dXNlZEVudGl0eSIgOiAibnNfc3VyZ2VyeTp0aXNzdWVTYW1wbGUiCiAgICAgICAgfSwKICAgICAgICAiXzpuNyIgOiB7CiAgICAgICAgICAicHJvdjpnZW5lcmF0ZWRFbnRpdHkiIDogIm5zX3N1cmdlcnk6dGlzc3VlU2FtcGxlIiwKICAgICAgICAgICJwcm92OnVzZWRFbnRpdHkiIDogIm5zX3N1cmdlcnk6cGF0aWVudCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgICJ3YXNHZW5lcmF0ZWRCeSIgOiB7CiAgICAgICAgIl86bjEzIiA6IHsKICAgICAgICAgICJwcm92OmVudGl0eSIgOiAibnNfc3VyZ2VyeTpTYW1wbGUiLAogICAgICAgICAgInByb3Y6YWN0aXZpdHkiIDogIm5zX3N1cmdlcnk6c2FtcGxlVHJhbnNwb3J0IgogICAgICAgIH0sCiAgICAgICAgIl86bjYiIDogewogICAgICAgICAgInByb3Y6ZW50aXR5IiA6ICJuc19zdXJnZXJ5OnRpc3N1ZVNhbXBsZSIsCiAgICAgICAgICAicHJvdjphY3Rpdml0eSIgOiAibnNfc3VyZ2VyeTpiaW9tYXRlcmlhbENvbGxlY3Rpb24iCiAgICAgICAgfSwKICAgICAgICAiXzpuOSIgOiB7CiAgICAgICAgICAicHJvdjplbnRpdHkiIDogIm5zX3N1cmdlcnk6cHJlcGFyZWRTYW1wbGUiLAogICAgICAgICAgInByb3Y6YWN0aXZpdHkiIDogIm5zX3N1cmdlcnk6c2FtcGxlUHJlcGFyYXRpb24iCiAgICAgICAgfSwKICAgICAgICAiXzpuMCIgOiB7CiAgICAgICAgICAicHJvdjplbnRpdHkiIDogInNlbGZfY29ubmVjdG9yOnNhbXBsZUNvbm5lY3RvciIsCiAgICAgICAgICAicHJvdjphY3Rpdml0eSIgOiAibnNfc3VyZ2VyeTpzYW1wbGVBY3F1aXNpdGlvbiIKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0=
        documentFormat:
          type: string
          description: Format of the document
          enum: 
            - json
            - rdf
            - xml
          example: json
        signature:
          type: string
          description: |
            Base64 encoded signature of the document (signature of document in the
            specified format, not the base64 encoded version)
          example: | 
            caL8f6soawkEi61/rgngxT94aI/Hvm+HNdiIqvqoxEJ+ClSFUQv8NFHYU9JzFX6m/9dPgpPKVLTPY1rJktw1KfBowEodFBO4SpGIShhYTb8znufEJApMIRNg85L0U0lmM5NzBw59fbow3Zc6aOLwnpF9rTZNqD8rwmhsTjNBz3k+5lisUU0+vyngvdMu0eeS//bhREvXfy8Hihu4HNLrMvROTnWW6v+GtCBMKLk+F1n1kP2+m1cstVvkREiIsODSLAuv56v+rffjIoawund3KpLUDeWnrAP4kw1jKjEOK17WMjQBmh4PCDut3lWjWISVd0vnH7oeBZqvdw7VsoRvnw==
        createdOn:
          type: integer
          description: Unix epoch timestamp of the creation of the document
          example: 842565600
    DocumentNoTrustedParty:
      description: | 
        This object is expected only when 'disableTrustedParty' configuration option is set to True
      type: object
      required:
       - document
       - documentFormat
      properties:
        document:
          type: string
          description: Base64 encoded PROV document
        documentFormat:
          type: string
          description: Format of the document
          enum: 
            - json
            - rdf
            - xml
          example: json
    Error:
      description: Error with problem details
      type: object
      properties:
        error:
          type: string
          description: Description of the error
          example: Error description
    Token:
      description: Non-repudiation token
      type: object
      properties:
        data:
          type: object
          description: Data of the token
          properties:
            originatorId:
              type: string
              example: "MUNI"
            authorityId:
              type: string
              example: "TrustedParty"
            tokenTimestamp:
              type: integer
              example: 1711984303
            messageTimestamp:
              type: integer
              example: 1711984302
            graphImprint:
              type: string
              description: A digest of the document
              example: "08976e714e2f0e5a5405a58cb605f97f9de080ff4d68af1ff4216f2d7dd9c80f"
            additionalData:
              type: object
              properties:
                bundleId:
                  type: string
                  example: "01_sample_acquisition"
                hashFunction:
                  type: string
                  example: "SHA256"
                trustedPartyUri:
                  type: string
                  description: URL of the trusted party that issue the token
                  example: "default-trusted-party.com:8020"
                trustedPartyCertificate:
                  type: string
                  description: URL of the trusted party that issue the token
                  example: |
                    "-----BEGIN CERTIFICATE-----
                          -----SNIP-----
                     -----END CERTIFICATE-----"
        signature:
          type: string
          description: Signature of the data (the data is canonicalized according to RFC 8785)
          example: | 
            OL4yTKw2tEusqj/iF+/vgS70IAcVUfI4iWtJCrlq2OldUTxjshf0iauuSN0U98k0Neu4ICGpc
            Yf3W80kWGMhIhL669vhRXVtaoI9lTjolUG71IB1USDp8vztYVBRMkirbcuBi/YgsIyt9GrLZyJLCT+tRAaFiEm
            mM3F8/tNN3REPyBNZ5rrHv6Yf3mdqRXkFTdzdw2GtGDZmfKQMpsUFo42lcl2vgFqaiXaPxU8Pgj6j3sXAQpylw
            KXe4jjLM/xNMy7bQD6fp9Q7RLrIKNtYo8ohS9SXReiUwP0hKlpNl76QUumWwvJRB7ZDCvaGlrYGjPcX5Xzl5xB
            Z+M7o1UYqJg==
    RetrievedDocument:
      description: Document with a non-repudiation token
      type: object
      properties:
        document:
          type: string
          description: Base64 encoded document
        token:
            $ref: '#/components/schemas/Token'
    ConectorTable:
      type: object
      properties:
        document:
          type: string
          description: Base64 encoded connector table (in PROV)
